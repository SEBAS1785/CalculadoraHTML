<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>One Piece Calculator (jQuery + Som fixo)</title>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=IM+Fell+English+SC&display=swap');

body {
  margin: 0;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: url("transferir") no-repeat center/cover;
  font-family: 'IM Fell English SC', serif;
  color: white;
}

.calc {
  width: 350px;
  background: rgba(0, 0, 0, 0.65);
  padding: 22px;
  border-radius: 20px;
  border: 3px solid #e8b200;
  box-shadow: 0 0 25px #e8b200;
  backdrop-filter: blur(5px);
}

.title {
  text-align: center;
  margin-bottom: 10px;
  color: #ffd34d;
  font-size: 28px;
  text-shadow: 0 0 8px black, 0 0 12px #e8b200;
}

.strawhat {
  width: 70px;
  display: block;
  margin: 0 auto 12px;
  filter: drop-shadow(0 0 6px #e8b200);
}

.display {
  width: 100%;
  height: 85px;
  background: #00101f;
  color: #ffd34d;
  font-size: 38px;
  text-align: right;
  padding: 15px;
  border-radius: 12px;
  overflow: hidden;
  box-sizing: border-box;
  margin-bottom: 15px;
  border: 2px solid #ffd34d;
  text-shadow: 0 0 6px black;
}

.keys {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
}

button {
  padding: 20px;
  font-size: 20px;
  border: none;
  border-radius: 12px;
  background: #e63946;
  color: #fff6d0;
  cursor: pointer;
  transition: 0.2s;
  font-family: 'IM Fell English SC', serif;
  text-shadow: 0 0 6px black;
  border: 2px solid #ffd34d;
}

button.operator {
  background: #1d3557;
}

button.equal {
  background: #ffd34d;
  color: #000;
  grid-column: span 2;
  font-weight: bold;
  box-shadow: 0 0 10px #ffd34d;
}

button:hover {
  transform: scale(0.90);
  filter: brightness(85%);
}
</style>
</head>

<body>

<div class="calc">
  <img class="strawhat" src="transferir.jfif">
  <div class="title">ONE PIECE CALCULATOR</div>

  <div class="display" id="display">0</div>

  <div class="keys">
    <button data-action="clear">AC</button>
    <button data-action="invert">±</button>
    <button data-action="percent">%</button>
    <button class="operator" data-op="/">÷</button>

    <button data-num="7">7</button>
    <button data-num="8">8</button>
    <button data-num="9">9</button>
    <button class="operator" data-op="*">×</button>

    <button data-num="4">4</button>
    <button data-num="5">5</button>
    <button data-num="6">6</button>
    <button class="operator" data-op="-">−</button>

    <button data-num="1">1</button>
    <button data-num="2">2</button>
    <button data-num="3">3</button>
    <button class="operator" data-op="+">+</button>

    <button data-num="0" style="grid-column: span 2;">0</button>
    <button data-num=".">.</button>
    <button class="equal" data-action="equal">=</button>
  </div>
</div>

<!-- Sons curtos e compatíveis -->
<audio id="sound-click" src="https://www.soundjay.com/buttons/sounds/button-16.mp3"></audio>
<audio id="sound-operator" src="https://www.soundjay.com/mechanical/sounds/mechanical-switch-05.mp3"></audio>
<audio id="sound-equal" src="https://www.soundjay.com/buttons/sounds/button-29.mp3"></audio>
<audio id="sound-clear" src="https://www.soundjay.com/buttons/sounds/button-10.mp3"></audio>

<script>
$(function() {
  let first = null;
  let operator = null;
  let reset = false;
  const $display = $("#display");

  function playSound(id) {
    const sound = $(id)[0];
    sound.currentTime = 0;
    sound.volume = 0.5;
    sound.play().catch(()=>{}); // previne bloqueio se não permitido
  }

  function updateDisplay(value) {
    $display.text(value);
  }

  function current() {
    return parseFloat($display.text());
  }

  function addNumber(num) {
    playSound("#sound-click");
    if ($display.text() === "0" || reset) {
      updateDisplay(num === "." ? "0." : num);
      reset = false;
    } else {
      if (num === "." && $display.text().includes(".")) return;
      updateDisplay($display.text() + num);
    }
  }

  function clearAll() {
    playSound("#sound-clear");
    updateDisplay("0");
    first = null;
    operator = null;
    reset = false;
  }

  function invert() {
    playSound("#sound-click");
    updateDisplay(String(current() * -1));
  }

  function percent() {
    playSound("#sound-click");
    updateDisplay(String(current() / 100));
  }

  function setOperator(op) {
    playSound("#sound-operator");
    if (first !== null && !reset) calculate();
    first = $display.text();
    operator = op;
    reset = true;
  }

  function calculate() {
    playSound("#sound-equal");
    if (first === null || operator === null) return;
    let a = parseFloat(first);
    let b = current();
    let res = 0;

    switch (operator) {
      case "+": res = a + b; break;
      case "-": res = a - b; break;
      case "*": res = a * b; break;
      case "/": res = b === 0 ? "ERRO" : a / b; break;
    }

    updateDisplay(res);
    first = null;
    operator = null;
    reset = true;
  }

  // Eventos
  $("[data-num]").on("click", function() { addNumber($(this).data("num")); });
  $("[data-action='clear']").on("click", clearAll);
  $("[data-action='invert']").on("click", invert);
  $("[data-action='percent']").on("click", percent);
  $("[data-op]").on("click", function() { setOperator($(this).data("op")); });
  $("[data-action='equal']").on("click", calculate);
});
</script>

</body>
</html>
